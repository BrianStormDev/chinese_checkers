<?xml version="1.0"?>
<launch>

    <!-- Ensure the workspace setup files are sourced -->
    <env name="ROS_PACKAGE_PATH" value="~ee106a/sawyer_setup.bash:${ROS_PACKAGE_PATH}" />
    <env name="ROS_PACKAGE_PATH" value="$(find internal)/../../devel/setup.bash:${ROS_PACKAGE_PATH}" />

    <!-- Start the joint trajectory action server in a new terminal -->
    <node pkg="intera_interface" type="joint_trajectory_action_server.py" name="joint_trajectory_action_server" output="screen" launch-prefix="xterm -e"/>

    <!-- Launch MoveIt for Sawyer with electric gripper enabled in a new terminal -->
    <include file="$(find sawyer_moveit_config)/launch/sawyer_moveit.launch">
        <arg name="electric_gripper" value="true"/>
        <launch-prefix>xterm -e</launch-prefix>
    </include>

    <!-- Launch the AR tag tracking and camera configuration in a new terminal -->
    <include file="$(find sawyer_full_stack)/launch/sawyer_camera_track.launch">
        <launch-prefix>xterm -e</launch-prefix>
    </include>

    <!-- Launch the RealSense camera driver in a new terminal -->
    <include file="$(find realsense2_camera)/launch/rs_camera.launch">
        <launch-prefix>xterm -e</launch-prefix>
    </include>

    <!-- Run the custom Python script for sawyer_full_stack in a new terminal -->
    <node name="sawyer_main" pkg="sawyer_full_stack" type="main.py" output="screen" cwd="$(find sawyer_full_stack)/src" launch-prefix="xterm -e"/>

    <!-- Run the custom Python script for internal after activating virtual environment in a new terminal -->
    <group ns="internal">
        <env name="VIRTUAL_ENV" value="/home/tmp/ee106a-air/myenv/bin/activate" />
        <node name="internal_main" pkg="internal" type="main.py" output="screen" cwd="$(find internal)/src" launch-prefix="xterm -e"/>
    </group>

</launch>
